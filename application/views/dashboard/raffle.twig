{% extends 'dashboard/layout.twig' %}

{% block content %}
    <div class="col-lg-12">
        {% if message is not empty %}
        <div class="alert alert-info"><i class="fa fa-fw fa-exclamation-triangle"></i> {{ message[0]|trans }}</div>
        {% endif %}
    
        <h1>Raffles</h1>
    </div>
    <div class="col-lg-3">
        {% include 'dashboard/includes/admin.sidebar.twig' %}
    </div>
    <div class="col-lg-9">
    <button class="btn btn-success btn-sm pull-right" data-toggle="modal" data-target="#raffleModal" data-type="2"><i class="fa fa-fw fa-plus"></i> New Raffle</button>
    <a href="{{ path('raffle_overview', {tab: 1}) }}" class="btn btn-success btn-sm"><i class="fa fa-fw fa-check"></i> Active Raffles</a>
    <a href="{{ path('raffle_overview', {tab: 2}) }}" class="btn btn-warning btn-sm"><i class="fa fa-fw fa-refresh"></i> Pending Raffles</a>
    <br/><br/>
    <h1>{{ tab[1]|capitalize }} raffles</h1>
    
    <div class="form-group">
        <input type="text"name="q" class="form-control" placeholder="Search ..." data-tab="{{ tab[0] }}" autofocus/>
    </div>
    
    {% if raffles|length > 0 %}
    <table class="table table-striped table-bordered table-hover table-condensed">
    <thead>
        <tr>
            <th>Title</th>
            <th>Start - End Date</th>
            <th>Winners</th>
            <th>Consolations</th>
            {% if tab[0] == 2 %}<th>Actions</th>{% endif %}
        </tr>
    </thead>
    <tbody>
    {% for raffle in raffles %}
        <tr data-raffle='{"id": "{{ raffle.getId }}","title": "{{ raffle.getRaffleTitle }}","start": "{{ raffle.getStartDate|date('Y-m-d') }}","end": "{{ raffle.getEndDate|date('Y-m-d') }}","winners": "{{ raffle.getWinners }}","consos": "{{ raffle.getConsolations }}"}'>
            <td>{{ raffle.getRaffleTitle }}</td>
            <td>{{ raffle.getStartDate|date('Y-m-d') }} - {{ raffle.getEndDate|date('Y-m-d') }}</td>
            <td>{{ raffle.getWinners|number_format }} person(s)</td>
            <td>{{ raffle.getConsolations|number_format }} person(s)</td>
            {% if tab[0] == 2 %}
            <td class="actions-btn">
                <div class="btn-group" role="group" aria-label="...">
                  <a href="{{ path('raffle_active', {id: raffle.getId, tab: tab[0]}) }}" class="btn btn-success btn-xs btn-activate"><i class="fa fa-fw fa-check"></i></a>
                  <a href="{{ path('raffle_delete', {id: raffle.getId, tab: tab[0]}) }}" class="btn btn-danger btn-xs btn-delete"><i class="fa fa-fw fa-trash-o"></i></a>
                  <a href="#" class="btn btn-info btn-xs" data-toggle="modal" data-target="#raffleModal" data-type="2"><i class="fa fa-fw fa-pencil"></i></a>
                </div>
            </td>
            {% endif %}
        </tr>
    {% endfor %}
    </tbody>
    </table>
{% else %}
    <div class="alert alert-warning" style="margin-top:15px"><i class="fa fa-fw fa-exclamation-triangle"></i> No {{ tab[1] }} records yet.</div>
{% endif %}
    
    </div>
    
    {% include 'dashboard/includes/modal.raffle.twig' %}
{% endblock %}

{% block scripts %}
    <script src="{{ baseUrl }}js/jq.admin.functions.js"></script>
{% endblock %}